<h2>Get a Quote</h2>
<p class="text-muted">Enter basic policy details to generate a quote for your coverage.</p>

<form action="/policies/new" method="post" class="mt-3">
  <div class="mb-3">
    <label class="form-label">Policy Type</label>
    <select id="policyType" name="type_id" class="form-select">
      <option value="1">Auto</option>
      <option value="2">Home</option>
      <option value="3">Pet</option>
      <option value="4">Renters</option>
      <option value="5">Business</option>
      <option value="6">Health</option>
      <option value="7">Life</option>
    </select>
  </div>
  <div class="row">
    <div class="col-md-4 mb-3">
      <label class="form-label">Start Date</label>
      <input type="date" name="start_date" class="form-control" value="<%= old.start_date || '' %>">
    </div>
    <div class="col-md-4 mb-3">
      <label class="form-label">End Date</label>
      <input type="date" name="end_date" class="form-control" value="<%= old.end_date || '' %>">
    </div>
    <div class="col-md-4 mb-3">
      <label class="form-label">Base Premium</label>
      <input type="number" name="base_premium" step="0.01" class="form-control" value="<%= old.base_premium || '' %>">
    </div>
  </div>
  <% if (errors && errors.length) { %>
    <div class="alert alert-danger">
      <ul class="mb-0">
        <% errors.forEach(e => { %>
          <li><%= e.msg %></li>
        <% }) %>
      </ul>
    </div>
  <% } %>

  <!-- Auto-specific fields -->
  <div id="autoFields" style="display: none;">
    <h5>Auto Details</h5>
    <div class="row">
      <div class="col-md-4 mb-3">
        <label class="form-label">Vehicle Make</label>
        <input type="text" name="vehicle_make" class="form-control" value="<%= old.vehicle_make || '' %>">
      </div>
      <div class="col-md-4 mb-3">
        <label class="form-label">Model</label>
        <input type="text" name="vehicle_model" class="form-control" value="<%= old.vehicle_model || '' %>">
      </div>
      <div class="col-md-2 mb-3">
        <label class="form-label">Year</label>
        <input type="number" name="vehicle_year" class="form-control" value="<%= old.vehicle_year || '' %>">
      </div>
      <div class="col-md-2 mb-3">
        <label class="form-label">VIN</label>
        <input type="text" name="vehicle_vin" class="form-control" value="<%= old.vehicle_vin || '' %>">
      </div>
    </div>
    <div class="row">
      <div class="col-md-4 mb-3">
        <label class="form-label">Coverage Type</label>
        <input type="text" name="auto_coverage_type" class="form-control" value="<%= old.auto_coverage_type || '' %>">
      </div>
      <div class="col-md-4 mb-3">
        <label class="form-label">Estimated Premium</label>
        <input type="number" name="auto_premium" step="0.01" class="form-control" value="<%= old.auto_premium || '' %>">
      </div>
    </div>
  </div>

  <!-- Home-specific fields -->
  <div id="homeFields" style="display: none;">
    <h5>Home Details</h5>
    <div class="mb-3">
      <label class="form-label">Property Address</label>
      <input type="text" name="property_address" class="form-control" value="<%= old.property_address || '' %>">
    </div>
    <div class="row">
      <div class="col-md-4 mb-3">
        <label class="form-label">Property Value</label>
        <input type="number" name="property_value" step="0.01" class="form-control" value="<%= old.property_value || '' %>">
      </div>
      <div class="col-md-4 mb-3">
        <label class="form-label">Coverage Limit</label>
        <input type="number" name="coverage_limit" step="0.01" class="form-control" value="<%= old.coverage_limit || '' %>">
      </div>
      <div class="col-md-4 mb-3">
        <label class="form-label">Deductible</label>
        <input type="number" name="home_deductible" step="0.01" class="form-control" value="<%= old.home_deductible || '' %>">
      </div>
    </div>
  </div>

  <!-- Pet-specific fields -->
  <div id="petFields" style="display: none;">
    <h5>Pet Details</h5>
    <div class="row">
      <div class="col-md-4 mb-3">
        <label class="form-label">Pet Name</label>
        <input type="text" name="pet_name" class="form-control" value="<%= old.pet_name || '' %>">
      </div>
      <div class="col-md-4 mb-3">
        <label class="form-label">Species</label>
        <input type="text" name="species" class="form-control" value="<%= old.species || '' %>">
      </div>
      <div class="col-md-4 mb-3">
        <label class="form-label">Age</label>
        <input type="number" name="pet_age" class="form-control" value="<%= old.pet_age || '' %>">
      </div>
    </div>
    <div class="row">
      <div class="col-md-4 mb-3">
        <label class="form-label">Deductible</label>
        <input type="number" name="pet_deductible" step="0.01" class="form-control" value="<%= old.pet_deductible || '' %>">
      </div>
      <div class="col-md-4 mb-3">
        <label class="form-label">Coverage Amount</label>
        <input type="number" name="pet_coverage_amount" step="0.01" class="form-control" value="<%= old.pet_coverage_amount || '' %>">
      </div>
    </div>
  </div>

  <!-- Renters-specific fields -->
  <div id="rentersFields" style="display: none;">
    <h5>Renters Details</h5>
    <div class="mb-3">
      <label class="form-label">Rental Address</label>
      <input type="text" name="rental_address" class="form-control" value="<%= old.rental_address || '' %>">
    </div>
    <div class="row">
      <div class="col-md-4 mb-3">
        <label class="form-label">Personal Property Value</label>
        <input type="number" name="personal_property_value" step="0.01" class="form-control" value="<%= old.personal_property_value || '' %>">
      </div>
      <div class="col-md-4 mb-3">
        <label class="form-label">Term</label>
        <input type="text" name="renters_term" class="form-control" value="<%= old.renters_term || '' %>">
      </div>
      <div class="col-md-4 mb-3">
        <label class="form-label">Deductible</label>
        <input type="number" name="renters_deductible" step="0.01" class="form-control" value="<%= old.renters_deductible || '' %>">
      </div>
      <div class="col-md-4 mb-3">
        <label class="form-label">Coverage Type</label>
        <input type="text" name="renters_coverage_type" class="form-control" value="<%= old.renters_coverage_type || '' %>">
      </div>
    </div>
  </div>

  <!-- Business-specific fields -->
  <div id="businessFields" style="display: none;">
    <h5>Business Details</h5>
    <div class="row">
      <div class="col-md-6 mb-3">
        <label class="form-label">Business Name</label>
        <input type="text" name="business_name" class="form-control" value="<%= old.business_name || '' %>">
      </div>
      <div class="col-md-6 mb-3">
        <label class="form-label">Business Type</label>
        <input type="text" name="business_type" class="form-control" value="<%= old.business_type || '' %>">
      </div>
    </div>
    <div class="row">
      <div class="col-md-4 mb-3">
        <label class="form-label">Industry</label>
        <input type="text" name="industry" class="form-control" value="<%= old.industry || '' %>">
      </div>
      <div class="col-md-4 mb-3">
        <label class="form-label">Annual Revenue</label>
        <input type="number" name="annual_revenue" step="0.01" class="form-control" value="<%= old.annual_revenue || '' %>">
      </div>
      <div class="col-md-4 mb-3">
        <label class="form-label">Number of Employees</label>
        <input type="number" name="number_of_employees" class="form-control" value="<%= old.number_of_employees || '' %>">
      </div>
    </div>
    <div class="row">
      <div class="col-md-4 mb-3">
        <label class="form-label">Business Address</label>
        <input type="text" name="business_address" class="form-control" value="<%= old.business_address || '' %>">
      </div>
      <div class="col-md-4 mb-3">
        <label class="form-label">Contact Number</label>
        <input type="text" name="contact_number" class="form-control" value="<%= old.contact_number || '' %>">
      </div>
      <div class="col-md-4 mb-3">
        <label class="form-label">Contact Email</label>
        <input type="email" name="contact_email" class="form-control" value="<%= old.contact_email || '' %>">
      </div>
    </div>
    <div class="row">
      <div class="col-md-4 mb-3">
        <label class="form-label">Deductible</label>
        <input type="number" name="business_deductible" step="0.01" class="form-control" value="<%= old.business_deductible || '' %>">
      </div>
      <div class="col-md-4 mb-3">
        <label class="form-label">Coverage Type</label>
        <input type="text" name="business_coverage_type" class="form-control" value="<%= old.business_coverage_type || '' %>">
      </div>
    </div>
  </div>

  <!-- Health-specific fields -->
  <div id="healthFields" style="display: none;">
    <h5>Health Details</h5>
    <div class="row">
      <div class="col-md-4 mb-3">
        <label class="form-label">Provider</label>
        <input type="text" name="provider" class="form-control" value="<%= old.provider || '' %>">
      </div>
      <div class="col-md-4 mb-3">
        <label class="form-label">Person Name</label>
        <input type="text" name="health_person_name" class="form-control" value="<%= old.health_person_name || '' %>">
      </div>
      <div class="col-md-4 mb-3">
        <label class="form-label">Plan</label>
        <input type="text" name="plan" class="form-control" value="<%= old.plan || '' %>">
      </div>
    </div>
    <div class="row">
      <div class="col-md-4 mb-3">
        <label class="form-label">Age</label>
        <input type="number" name="health_age" class="form-control" value="<%= old.health_age || '' %>">
      </div>
      <div class="col-md-4 mb-3">
        <label class="form-label">Deductible</label>
        <input type="number" name="health_deductible" step="0.01" class="form-control" value="<%= old.health_deductible || '' %>">
      </div>
    </div>
  </div>

  <!-- Life-specific fields -->
  <div id="lifeFields" style="display: none;">
    <h5>Life Details</h5>
    <div class="row">
      <div class="col-md-6 mb-3">
        <label class="form-label">Beneficiary</label>
        <input type="text" name="beneficiary" class="form-control" value="<%= old.beneficiary || '' %>">
      </div>
      <div class="col-md-6 mb-3">
        <label class="form-label">Person Name</label>
        <input type="text" name="life_person_name" class="form-control" value="<%= old.life_person_name || '' %>">
      </div>
    </div>
    <div class="row">
      <div class="col-md-4 mb-3">
        <label class="form-label">Term</label>
        <input type="text" name="life_term" class="form-control" value="<%= old.life_term || '' %>">
      </div>
      <div class="col-md-4 mb-3">
        <label class="form-label">Age</label>
        <input type="number" name="life_age" class="form-control" value="<%= old.life_age || '' %>">
      </div>
      <div class="col-md-4 mb-3">
        <label class="form-label">Deductible</label>
        <input type="number" name="life_deductible" step="0.01" class="form-control" value="<%= old.life_deductible || '' %>">
      </div>
    </div>
  </div>
  <button class="btn btn-primary" type="submit">Create Quote</button>
</form>

<script>
  (function(){
    const typeSelect = document.getElementById('policyType');
    const autoFields = document.getElementById('autoFields');
    const homeFields = document.getElementById('homeFields');
    const petFields = document.getElementById('petFields');
    const rentersFields = document.getElementById('rentersFields');
    const businessFields = document.getElementById('businessFields');
    const healthFields = document.getElementById('healthFields');
    const lifeFields = document.getElementById('lifeFields');

    function hideAll() {
      [autoFields, homeFields, petFields, rentersFields, businessFields, healthFields, lifeFields].forEach(el => {
        if (el) el.style.display = 'none';
      });
    }

    function updateFields() {
      hideAll();
      const val = typeSelect.value;
      switch (val) {
        case '1': autoFields.style.display = ''; break;
        case '2': homeFields.style.display = ''; break;
        case '3': petFields.style.display = ''; break;
        case '4': rentersFields.style.display = ''; break;
        case '5': businessFields.style.display = ''; break;
        case '6': healthFields.style.display = ''; break;
        case '7': lifeFields.style.display = ''; break;
        default: break;
      }
    }

    typeSelect.addEventListener('change', updateFields);
    // initial
    updateFields();
  })();
</script>

