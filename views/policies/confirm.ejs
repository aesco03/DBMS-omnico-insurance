<h2>Confirm Quote</h2>

<p class="text-muted">Please review the computed quote below. Accept to create the policy, or Cancel to edit.</p>

<div class="card mb-3">
  <div class="card-body">
    <h5>Coverage</h5>
    <ul>
      <li><strong>Type:</strong> <%= type_id === 1 ? 'Auto' : (type_id === 2 ? 'Home' : 'Other') %></li>
      <li><strong>Start:</strong> <%= start_date %></li>
      <li><strong>End:</strong> <%= end_date %></li>
    </ul>

    <% if (type_id === 1) { %>
      <h6>Auto facts</h6>
      <ul>
        <li>Make: <%= facts.vehicle_make || '-' %></li>
        <li>Model: <%= facts.vehicle_model || '-' %></li>
        <li>Year: <%= facts.vehicle_year || '-' %></li>
        <li>VIN: <%= facts.vehicle_vin || '-' %></li>
        <li>Coverage: <%= facts.coverage_type || '-' %></li>
      </ul>
    <% } else if (type_id === 2) { %>
      <h6>Home facts</h6>
      <ul>
        <li>Address: <%= facts.property_address || '-' %></li>
        <li>Property value: $<%= facts.property_value || '-' %></li>
        <li>Deductible: $<%= facts.deductible || '-' %></li>
      </ul>
    <% } %>

    <h5>Computed Quote</h5>
    <ul>
      <li><strong>Premium:</strong> $<%= derived.premium %></li>
      <li><strong>Suggested coverage limit:</strong> $<%= derived.coverage_limit %></li>
    </ul>

    <form method="post" action="/policies/confirm">
      <!-- pass facts back as hidden fields; server will recompute for safety -->
      <input type="hidden" name="type_id" value="<%= type_id %>">
      <input type="hidden" name="start_date" value="<%= start_date %>">
      <input type="hidden" name="end_date" value="<%= end_date %>">

      <% if (type_id === 1) { %>
        <input type="hidden" name="vehicle_make" value="<%= facts.vehicle_make || '' %>">
        <input type="hidden" name="vehicle_model" value="<%= facts.vehicle_model || '' %>">
        <input type="hidden" name="vehicle_year" value="<%= facts.vehicle_year || '' %>">
        <input type="hidden" name="vehicle_vin" value="<%= facts.vehicle_vin || '' %>">
        <input type="hidden" name="coverage_type" value="<%= facts.coverage_type || '' %>">
      <% } else if (type_id === 2) { %>
        <input type="hidden" name="property_address" value="<%= facts.property_address || '' %>">
        <input type="hidden" name="property_value" value="<%= facts.property_value || '' %>">
        <input type="hidden" name="deductible" value="<%= facts.deductible || '' %>">
      <% } %>

      <button type="submit" class="btn btn-success">Accept Quote</button>
      <a href="/policies/new" class="btn btn-secondary">Cancel / Edit</a>
    </form>
  </div>
</div>
